import{p as e,a as t,r as a,o as s,c as r,b as n,w as o,d,t as i,e as l,F as c,f as u,g as h,v as p,h as g,K as m,X as _}from"./vendor.53a786df.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),r=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,n)=>{const o=new URL(e,s);if(self[t].moduleMap[o])return a(self[t].moduleMap[o]);const d=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(d),onerror(){n(new Error(`Failed to import: ${e}`)),r(i)},onload(){a(self[t].moduleMap[o]),r(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/lego-set-checker/assets/");var v={name:"Header",props:{contentSelector:String},data:()=>({searchedSet:"",sets:[]}),methods:{async onSearch(e){const t=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets`,{params:{search:e},headers:{Authorization:`key ${{}.VITE_API_KEY}`}});this.sets=t.data.results.map((e=>({label:`${e.set_num} | ${e.name}`,key:e.set_num})))},onSelect(e){this.searchedSet=e.label,this.$emit("setSelected",e.key)}},emits:["setSelected"]};const P=o("data-v-5e280fa9");e("data-v-5e280fa9");const S={class:"searchbar__icon"},f=d("search");t();const b=P(((e,t,o,d,i,l)=>{const c=a("ui-icon"),u=a("ui-autocomplete"),h=a("ui-top-app-bar");return s(),r(h,{"content-selector":o.contentSelector,title:"Lego Set Checker"},{toolbar:P((()=>[n(u,{"model-value":i.searchedSet,source:i.sets,class:"autocomplete",delay:"500",placeholder:"Search set by ID",remote:"",onSearch:l.onSearch,onSelected:l.onSelect},{after:P((()=>[n("div",S,[n(c,{dark:"",outlined:""},{default:P((()=>[f])),_:1})])])),_:1},8,["model-value","source","onSearch","onSelected"])])),_:1},8,["content-selector"])}));v.render=b,v.__scopeId="data-v-5e280fa9";var y={name:"SetCard",props:{searchedSet:null},methods:{async fetchParts(){this.$emit("fetchParts",this.searchedSet.set_num)}},emits:["fetchParts"]};const I=o("data-v-be5a67d4");e("data-v-be5a67d4");const C={key:0,class:"set-card__container"},$={class:"set-card__info"},w={class:"set-card__info-text"},k=n("div",{class:"set-card__info-labels"},[n("div",null,"Name:"),n("div",null,"Set-Number:"),n("div",null,"Parts:")],-1),x={class:"set-card__info-values"},E=d("Get parts");t();const A=I(((e,t,o,d,c,u)=>{const h=a("ui-button");return o.searchedSet?(s(),r("div",C,[n("img",{src:o.searchedSet.set_img_url,alt:"",class:"set-card__image",width:"200"},null,8,["src"]),n("div",$,[n("div",w,[k,n("div",x,[n("div",null,i(o.searchedSet.name),1),n("div",null,i(o.searchedSet.set_num),1),n("div",null,i(o.searchedSet.num_parts),1)])]),n(h,{raised:"",onClick:u.fetchParts},{default:I((()=>[E])),_:1},8,["onClick"])])])):l("",!0)}));y.render=A,y.__scopeId="data-v-be5a67d4";const L=e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):void 0},N=(e,t)=>{var a;const s=L(e);return s?null==(a=s.parts)?void 0:a.find((e=>e.id===t.id)):void 0};var U={name:"PartCard",props:{part:null},methods:{handlePersistPart(){((e,t)=>{var a;const s=L(e);if(!s)throw new Error(`set with id ${e} was not found in local storage`);s.parts=null==(a=s.parts)?void 0:a.map((e=>e.id===t.id?t:e)),localStorage.setItem(e,JSON.stringify(s))})(this.part.set_num,this.part)}}};const V=o("data-v-d940cbca");e("data-v-d940cbca");const O={key:0,class:"part-card__container"},R={class:"part-card__info"},T=n("div",{class:"part-card__info-labels"},[n("div",null,"Name:"),n("div",null,"Quantity:")],-1),M={class:"part-card__info-values"},j={class:"part-card__form"},z=n("hr",null,null,-1);t();const F=V(((e,t,o,d,u,h)=>{const p=a("ui-textfield");return s(),r(c,null,[o.part?(s(),r("div",O,[n("img",{src:o.part.part.part_img_url,alt:"",class:"part-card__image",width:"100"},null,8,["src"]),n("div",R,[T,n("div",M,[n("div",null,i(o.part.part.name),1),n("div",null,i(o.part.quantity),1)])]),n("div",j,[n(p,{modelValue:o.part.quantity_owned,"onUpdate:modelValue":t[1]||(t[1]=e=>o.part.quantity_owned=e),modelModifiers:{number:!0},"input-type":"number",placeholder:"Quantity owned",onChange:h.handlePersistPart},null,8,["modelValue","onChange"])])])):l("",!0),z],64)}));U.render=F,U.__scopeId="data-v-d940cbca";const K=(e,t)=>{const a=L(e);if(!a)throw new Error(`set with id ${e} was not found in local storage`);t.forEach((e=>{var t,s,r;a.parts||(a.parts=[]),(null==(s=null==(t=a.parts)?void 0:t.map((e=>e.id)))?void 0:s.includes(e.id))||null==(r=a.parts)||r.push(e)})),localStorage.setItem(e,JSON.stringify(a))},B=e=>parseInt(e.slice(e.indexOf("page=")+5,e.lastIndexOf("&")));var J={name:"PartsList",components:{PartCard:U},props:{parts:null,searchedSet:null,loading:!1,prevPage:"",nextPage:"",partsCount:null},methods:{handlePrev(){this.$emit("getPartsPage",this.prevPage)},handleNext(){this.$emit("getPartsPage",this.nextPage)},getCurrentPageNumber(){return this.nextPage?B(this.nextPage)-1:this.prevPage?B(this.prevPage)+1:void 0},getTotalPages(){return Math.ceil(this.partsCount/5)}},emits:["getPartsPage"]};const Y=o("data-v-297c00a0");e("data-v-297c00a0");const q={key:0,class:"parts-container"},G={key:0,class:"parts-list"},H={key:1,class:"parts-list"},Q={class:"page-buttons"},D=d("prev"),X=d("next");t();const W=Y(((e,t,o,d,h,p)=>{const g=a("ui-spinner"),m=a("PartCard"),_=a("ui-button");return o.parts&&o.searchedSet?(s(),r("div",q,[o.loading?(s(),r("div",G,[n(g,{active:""})])):(s(),r("div",H,[(s(!0),r(c,null,u(o.parts,(e=>(s(),r(m,{part:e},null,8,["part"])))),256))])),n("div",Q,[n(_,{disabled:!o.prevPage,raised:"",onClick:p.handlePrev},{default:Y((()=>[D])),_:1},8,["disabled","onClick"]),n("div",null,i(p.getCurrentPageNumber()||0)+" / "+i(p.getTotalPages()||0),1),n(_,{disabled:!o.nextPage,raised:"",onClick:p.handleNext},{default:Y((()=>[X])),_:1},8,["disabled","onClick"])])])):l("",!0)}));J.render=W,J.__scopeId="data-v-297c00a0";var Z={name:"app",components:{PartsList:J,PartCard:U,SetCard:y,Header:v},data:()=>({searchedSet:null,parts:[],nextPage:"",prevPage:"",loading:!1,partsCount:0}),methods:{async onSelect(e){const t=L();if(t)this.searchedSet=t;else{const t=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets/${e}`,{headers:{Authorization:`key ${{}.VITE_API_KEY}`}});this.searchedSet=t.data,localStorage.getItem(this.searchedSet.set_num)||localStorage.setItem(this.searchedSet.set_num,JSON.stringify(this.searchedSet))}},async getParts(){this.parts=[],this.loading=!0;const e=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets/${this.searchedSet.set_num}/parts`,{headers:{Authorization:`key ${{}.VITE_API_KEY}`},params:{page_size:5}});e.data.results.forEach((e=>{const t=N(this.searchedSet.set_num,e);t?this.parts.push(t):this.parts.push(e)})),this.loading=!1,this.partsCount=e.data.count,this.nextPage=e.data.next,this.prevPage=e.data.previous,K(this.searchedSet.set_num,this.parts)},async getPartsPage(e){this.loading=!0,this.parts=[];const t=await this.$http.get(e,{headers:{Authorization:`key ${{}.VITE_API_KEY}`}});t.data.results.forEach((e=>{const t=N(this.searchedSet.set_num,e);t?this.parts.push(t):this.parts.push(e)})),this.loading=!1,this.partsCount=t.data.count,this.nextPage=t.data.next,this.prevPage=t.data.previous,K(this.searchedSet.set_num,this.parts)}}};const ee={id:"root"},te=n("hr",{style:{margin:"0"}},null,-1);Z.render=function(e,t,o,d,i,l){const u=a("Header"),h=a("SetCard"),p=a("PartsList");return s(),r(c,null,[n(u,{"content-selector":"#root",onSetSelected:l.onSelect},null,8,["onSetSelected"]),n("div",ee,[n(h,{"searched-set":i.searchedSet,onFetchParts:l.getParts},null,8,["searched-set","onFetchParts"]),te,n(p,{loading:i.loading,"next-page":i.nextPage,parts:i.parts,"parts-count":i.partsCount,"prev-page":i.prevPage,"searched-set":i.searchedSet,onGetPartsPage:l.getPartsPage},null,8,["loading","next-page","parts","parts-count","prev-page","searched-set","onGetPartsPage"])])],64)};const ae=h(Z);ae.use(p,g),ae.use(m),ae.use(_),ae.mount("#app");
