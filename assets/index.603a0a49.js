import{p as e,a as t,r as a,o as s,c as r,b as n,w as i,d as l,t as d,e as o,F as c,f as u,g as h,v as p,h as g,K as _,X as m}from"./vendor.53a786df.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),r=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,n)=>{const i=new URL(e,s);if(self[t].moduleMap[i])return a(self[t].moduleMap[i]);const l=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),d=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){n(new Error(`Failed to import: ${e}`)),r(d)},onload(){a(self[t].moduleMap[i]),r(d)}});document.head.appendChild(d)})),self[t].moduleMap={}}}("/lego-set-checker/assets/");var v={name:"Header",props:{contentSelector:String},data:()=>({searchedSet:"",sets:[]}),methods:{async onSearch(e){const t=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets`,{params:{search:e},headers:{Authorization:`key ${{}.VITE_API_KEY}`}});this.sets=t.data.results.map((e=>({label:`${e.set_num} | ${e.name}`,key:e.set_num})))},onSelect(e){this.searchedSet=e.label,this.$emit("setSelected",e.key)}},emits:["setSelected"]};const P=i("data-v-5e280fa9");e("data-v-5e280fa9");const S={class:"searchbar__icon"},f=l("search");t();const y=P(((e,t,i,l,d,o)=>{const c=a("ui-icon"),u=a("ui-autocomplete"),h=a("ui-top-app-bar");return s(),r(h,{"content-selector":i.contentSelector,title:"Lego Set Checker"},{toolbar:P((()=>[n(u,{"model-value":d.searchedSet,source:d.sets,class:"autocomplete",delay:"500",placeholder:"Search set by ID",remote:"",onSearch:o.onSearch,onSelected:o.onSelect},{after:P((()=>[n("div",S,[n(c,{dark:"",outlined:""},{default:P((()=>[f])),_:1})])])),_:1},8,["model-value","source","onSearch","onSelected"])])),_:1},8,["content-selector"])}));v.render=y,v.__scopeId="data-v-5e280fa9";const b=e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):void 0},w=(e,t)=>{var a;const s=b(e);return s?null==(a=s.parts)?void 0:a.find((e=>e.id===t.id)):void 0};var I={name:"SetCard",props:{searchedSet:null},methods:{async fetchParts(){this.$emit("fetchParts",this.searchedSet.set_num)},getPartsMissing(){return(e=>{var t;const a=b(e);if(!a)return;let s=0;return null==(t=a.parts)||t.forEach((e=>{e.quantity_owned&&(s+=e.quantity_owned)})),a.num_parts-s})(this.searchedSet.set_num)},getUniquePartsMissing(){return(e=>{var t;const a=b(e);if(!a)return;let s=0;return null==(t=a.parts)||t.forEach((e=>{e.quantity_owned?e.quantity_owned<e.quantity&&s++:s++})),s})(this.searchedSet.set_num)}},emits:["fetchParts"]};const $=i("data-v-29e96681");e("data-v-29e96681");const C={key:0,class:"set-card__container"},E={class:"set-card__info"},x={class:"set-card__info-text"},k=n("div",{class:"set-card__info-labels"},[n("div",null,"Name:"),n("div",null,"Set-Number:"),n("div",null,"Parts:")],-1),M={class:"set-card__info-values"},A=l("Get parts"),L={class:"set-card__missing-parts"},U={class:"set-card__info-text"},q=n("div",{class:"set-card__info-labels"},[n("div",null,"Total:"),n("div",null,"Missing:"),n("div",null,"Unique missing:")],-1),N={class:"set-card__info-values right-align"},T=l("Export");t();const V=$(((e,t,i,l,c,u)=>{const h=a("ui-button");return i.searchedSet?(s(),r("div",C,[n("div",null,[n("img",{src:i.searchedSet.set_img_url,alt:"",class:"set-card__image",width:"200"},null,8,["src"])]),n("div",E,[n("div",x,[k,n("div",M,[n("div",null,d(i.searchedSet.name),1),n("div",null,d(i.searchedSet.set_num),1),n("div",null,d(i.searchedSet.num_parts),1)])]),n(h,{raised:"",onClick:u.fetchParts},{default:$((()=>[A])),_:1},8,["onClick"])]),n("div",L,[n("div",U,[q,n("div",N,[n("div",null,d(i.searchedSet.num_parts),1),n("div",null,d(u.getPartsMissing()||0),1),n("div",null,d(u.getUniquePartsMissing()||0),1)])]),n(h,{raised:""},{default:$((()=>[T])),_:1})])])):o("",!0)}));I.render=V,I.__scopeId="data-v-29e96681";var O={name:"PartCard",props:{part:null},methods:{handlePersistPart(){((e,t)=>{var a;const s=b(e);if(!s)throw new Error(`set with id ${e} was not found in local storage`);s.parts=null==(a=s.parts)?void 0:a.map((e=>e.id===t.id?t:e)),localStorage.setItem(e,JSON.stringify(s))})(this.part.set_num,this.part)}}};const R=i("data-v-d940cbca");e("data-v-d940cbca");const j={key:0,class:"part-card__container"},z={class:"part-card__info"},F=n("div",{class:"part-card__info-labels"},[n("div",null,"Name:"),n("div",null,"Quantity:")],-1),K={class:"part-card__info-values"},B={class:"part-card__form"},J=n("hr",null,null,-1);t();const Y=R(((e,t,i,l,u,h)=>{const p=a("ui-textfield");return s(),r(c,null,[i.part?(s(),r("div",j,[n("img",{src:i.part.part.part_img_url,alt:"",class:"part-card__image",width:"100"},null,8,["src"]),n("div",z,[F,n("div",K,[n("div",null,d(i.part.part.name),1),n("div",null,d(i.part.quantity),1)])]),n("div",B,[n(p,{modelValue:i.part.quantity_owned,"onUpdate:modelValue":t[1]||(t[1]=e=>i.part.quantity_owned=e),modelModifiers:{number:!0},"input-type":"number",placeholder:"Quantity owned",onChange:h.handlePersistPart},null,8,["modelValue","onChange"])])])):o("",!0),J],64)}));O.render=Y,O.__scopeId="data-v-d940cbca";const G=(e,t)=>{const a=b(e);if(!a)throw new Error(`set with id ${e} was not found in local storage`);t.forEach((e=>{var t,s,r;a.parts||(a.parts=[]),(null==(s=null==(t=a.parts)?void 0:t.map((e=>e.id)))?void 0:s.includes(e.id))||null==(r=a.parts)||r.push(e)})),localStorage.setItem(e,JSON.stringify(a))},H=e=>parseInt(e.slice(e.indexOf("page=")+5,e.lastIndexOf("&")));var Q={name:"PartsList",components:{PartCard:O},props:{parts:null,searchedSet:null,loading:!1,prevPage:"",nextPage:"",partsCount:null},methods:{handlePrev(){this.$emit("getPartsPage",this.prevPage)},handleNext(){this.$emit("getPartsPage",this.nextPage)},getCurrentPageNumber(){return this.nextPage?H(this.nextPage)-1:this.prevPage?H(this.prevPage)+1:void 0},getTotalPages(){return Math.ceil(this.partsCount/5)},updateMissingParts(){this.$emit("updateMissingParts")}},emits:["getPartsPage","updateMissingParts"]};const D=i("data-v-61fafcde");e("data-v-61fafcde");const X={key:0,class:"parts-container"},W={key:0,class:"parts-list"},Z={key:1,class:"parts-list"},ee={class:"page-buttons"},te=l("prev"),ae=l("next");t();const se=D(((e,t,i,l,h,p)=>{const g=a("ui-spinner"),_=a("PartCard"),m=a("ui-button");return i.parts&&i.searchedSet?(s(),r("div",X,[i.loading?(s(),r("div",W,[n(g,{active:""})])):(s(),r("div",Z,[(s(!0),r(c,null,u(i.parts,(e=>(s(),r(_,{part:e},null,8,["part"])))),256))])),n("div",ee,[n(m,{disabled:!i.prevPage,raised:"",onClick:p.handlePrev},{default:D((()=>[te])),_:1},8,["disabled","onClick"]),n("div",null,d(p.getCurrentPageNumber()||0)+" / "+d(p.getTotalPages()||0),1),n(m,{disabled:!i.nextPage,raised:"",onClick:p.handleNext},{default:D((()=>[ae])),_:1},8,["disabled","onClick"])])])):o("",!0)}));Q.render=se,Q.__scopeId="data-v-61fafcde";var re={name:"app",components:{PartsList:Q,PartCard:O,SetCard:I,Header:v},data:()=>({searchedSet:null,parts:[],nextPage:"",prevPage:"",loading:!1,partsCount:0}),methods:{async onSelect(e){const t=b();if(t)this.searchedSet=t;else{const t=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets/${e}`,{headers:{Authorization:`key ${{}.VITE_API_KEY}`}});this.searchedSet=t.data,localStorage.getItem(this.searchedSet.set_num)||localStorage.setItem(this.searchedSet.set_num,JSON.stringify(this.searchedSet))}},async getParts(){this.parts=[],this.loading=!0;const e=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets/${this.searchedSet.set_num}/parts`,{headers:{Authorization:`key ${{}.VITE_API_KEY}`},params:{page_size:5}});e.data.results.forEach((e=>{const t=w(this.searchedSet.set_num,e);t?this.parts.push(t):this.parts.push(e)})),this.loading=!1,this.partsCount=e.data.count,this.nextPage=e.data.next,this.prevPage=e.data.previous,G(this.searchedSet.set_num,this.parts)},async getPartsPage(e){this.loading=!0,this.parts=[];const t=await this.$http.get(e,{headers:{Authorization:`key ${{}.VITE_API_KEY}`}});t.data.results.forEach((e=>{const t=w(this.searchedSet.set_num,e);t?this.parts.push(t):this.parts.push(e)})),this.loading=!1,this.partsCount=t.data.count,this.nextPage=t.data.next,this.prevPage=t.data.previous,G(this.searchedSet.set_num,this.parts)}}};const ne={id:"root"},ie=n("hr",{style:{margin:"0"}},null,-1);re.render=function(e,t,i,l,d,o){const u=a("Header"),h=a("SetCard"),p=a("PartsList");return s(),r(c,null,[n(u,{"content-selector":"#root",onSetSelected:o.onSelect},null,8,["onSetSelected"]),n("div",ne,[n(h,{"searched-set":d.searchedSet,onFetchParts:o.getParts},null,8,["searched-set","onFetchParts"]),ie,n(p,{loading:d.loading,"next-page":d.nextPage,parts:d.parts,"parts-count":d.partsCount,"prev-page":d.prevPage,"searched-set":d.searchedSet,onGetPartsPage:o.getPartsPage},null,8,["loading","next-page","parts","parts-count","prev-page","searched-set","onGetPartsPage"])])],64)};const le=h(re);le.use(p,g),le.use(_),le.use(m),le.mount("#app");
