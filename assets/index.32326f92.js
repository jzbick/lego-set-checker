import{p as t,a as e,r as s,o as a,c as r,b as n,w as i,d as o,t as l,e as d,F as c,f as u,g as p,h,v as m,i as g,K as _,X as v}from"./vendor.890631eb.js";!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(s){const a=new URL(t,location),r=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((s,n)=>{const i=new URL(t,a);if(self[e].moduleMap[i])return s(self[e].moduleMap[i]);const o=new Blob([`import * as m from '${i}';`,`${e}.moduleMap['${i}']=m;`],{type:"text/javascript"}),l=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){n(new Error(`Failed to import: ${t}`)),r(l)},onload(){s(self[e].moduleMap[i]),r(l)}});document.head.appendChild(l)})),self[e].moduleMap={}}}("/lego-set-checker/assets/");var P={name:"Header",props:{contentSelector:String},data:()=>({searchedSet:"",sets:[]}),methods:{async onSearch(t){const e=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets`,{params:{search:t},headers:{Authorization:`key ${{}.VITE_API_KEY}`}});this.sets=e.data.results.map((t=>({label:`${t.set_num} | ${t.name}`,key:t.set_num})))},onSelect(t){this.searchedSet=t.label,this.$emit("setSelected",t.key)}},emits:["setSelected"]};const f=i("data-v-5e280fa9");t("data-v-5e280fa9");const S={class:"searchbar__icon"},$=o("search");e();const y=f(((t,e,i,o,l,d)=>{const c=s("ui-icon"),u=s("ui-autocomplete"),p=s("ui-top-app-bar");return a(),r(p,{"content-selector":i.contentSelector,title:"Lego Set Checker"},{toolbar:f((()=>[n(u,{"model-value":l.searchedSet,source:l.sets,class:"autocomplete",delay:"500",placeholder:"Search set by ID",remote:"",onSearch:d.onSearch,onSelected:d.onSelect},{after:f((()=>[n("div",S,[n(c,{dark:"",outlined:""},{default:f((()=>[$])),_:1})])])),_:1},8,["model-value","source","onSearch","onSelected"])])),_:1},8,["content-selector"])}));P.render=y,P.__scopeId="data-v-5e280fa9";const w=t=>{const e=localStorage.getItem(t);return e?JSON.parse(e):void 0};var b={name:"SetCard",computed:{set(){return this.$store.state.set}},methods:{async fetchParts(){this.$emit("fetchParts",this.set.set_num)},getPartsMissing(){return(t=>{var e;const s=w(t);if(!s)return;let a=0;return null==(e=s.parts)||e.forEach((t=>{t.quantity_owned&&(a+=t.quantity_owned)})),s.num_parts-a})(this.set.set_num)},getUniquePartsMissing(){return(t=>{var e;const s=w(t);if(!s)return;let a=0;return null==(e=s.parts)||e.forEach((t=>{t.quantity_owned?t.quantity_owned<t.quantity&&a++:a++})),a})(this.set.set_num)}},emits:["fetchParts"]};const I=i("data-v-43cd1c3c");t("data-v-43cd1c3c");const C={key:0,class:"set-card__container"},x={class:"set-card__info"},E={class:"set-card__info-text"},k=n("div",{class:"set-card__info-labels"},[n("div",null,"Name:"),n("div",null,"Set-Number:"),n("div",null,"Parts:")],-1),N={class:"set-card__info-values"},M=o("Get parts"),A={class:"set-card__missing-parts"},L={class:"set-card__info-text"},U=n("div",{class:"set-card__info-labels"},[n("div",null,"Total:"),n("div",null,"Missing:"),n("div",null,"Unique missing:")],-1),R={class:"set-card__info-values right-align"},q=o("Export");e();const O=I(((t,e,i,o,c,u)=>{const p=s("ui-button");return u.set?(a(),r("div",C,[n("div",null,[n("img",{src:u.set.set_img_url,alt:"",class:"set-card__image",width:"200"},null,8,["src"])]),n("div",x,[n("div",E,[k,n("div",N,[n("div",null,l(u.set.name),1),n("div",null,l(u.set.set_num),1),n("div",null,l(u.set.num_parts),1)])]),n(p,{raised:"",onClick:u.fetchParts},{default:I((()=>[M])),_:1},8,["onClick"])]),n("div",A,[n("div",L,[U,n("div",R,[n("div",null,l(u.set.num_parts),1),n("div",null,l(u.getPartsMissing()||0),1),n("div",null,l(u.getUniquePartsMissing()||0),1)])]),n(p,{raised:""},{default:I((()=>[q])),_:1})])])):d("",!0)}));b.render=O,b.__scopeId="data-v-43cd1c3c";var T={name:"PartCard",props:{part:null},methods:{handlePersistPart(){((t,e)=>{var s;const a=w(t);if(!a)throw new Error(`set with id ${t} was not found in local storage`);a.parts=null==(s=a.parts)?void 0:s.map((t=>t.id===e.id?e:t)),localStorage.setItem(t,JSON.stringify(a))})(this.part.set_num,this.part)}}};const V=i("data-v-d940cbca");t("data-v-d940cbca");const j={key:0,class:"part-card__container"},z={class:"part-card__info"},F=n("div",{class:"part-card__info-labels"},[n("div",null,"Name:"),n("div",null,"Quantity:")],-1),J={class:"part-card__info-values"},K={class:"part-card__form"},B=n("hr",null,null,-1);e();const Y=V(((t,e,i,o,u,p)=>{const h=s("ui-textfield");return a(),r(c,null,[i.part?(a(),r("div",j,[n("img",{src:i.part.part.part_img_url,alt:"",class:"part-card__image",width:"100"},null,8,["src"]),n("div",z,[F,n("div",J,[n("div",null,l(i.part.part.name),1),n("div",null,l(i.part.quantity),1)])]),n("div",K,[n(h,{modelValue:i.part.quantity_owned,"onUpdate:modelValue":e[1]||(e[1]=t=>i.part.quantity_owned=t),modelModifiers:{number:!0},"input-type":"number",placeholder:"Quantity owned",onChange:p.handlePersistPart},null,8,["modelValue","onChange"])])])):d("",!0),B],64)}));T.render=Y,T.__scopeId="data-v-d940cbca";const G=t=>parseInt(t.slice(t.indexOf("page=")+5,t.lastIndexOf("&")));var H={name:"PartsList",components:{PartCard:T},props:{loading:!1,partsCount:null},computed:{set(){return this.$store.state.set},parts(){return this.$store.state.parts},nextPage(){return this.$store.state.nextPage},prevPage(){return this.$store.state.prevPage}},methods:{handlePrev(){this.$emit("getPartsPage",this.prevPage)},handleNext(){this.$emit("getPartsPage",this.nextPage)},getCurrentPageNumber(){return this.nextPage?G(this.nextPage)-1:this.prevPage?G(this.prevPage)+1:void 0},getTotalPages(){return Math.ceil(this.partsCount/5)},updateMissingParts(){this.$emit("updateMissingParts")}},emits:["getPartsPage","updateMissingParts"]};const Q=i("data-v-6acd8266");t("data-v-6acd8266");const D={key:0,class:"parts-container"},X={key:0,class:"parts-list"},W={key:1,class:"parts-list"},Z={class:"page-buttons"},tt=o("prev"),et=o("next");e();const st=Q(((t,e,i,o,p,h)=>{const m=s("ui-spinner"),g=s("PartCard"),_=s("ui-button");return h.parts&&h.set?(a(),r("div",D,[i.loading?(a(),r("div",X,[n(m,{active:""})])):(a(),r("div",W,[(a(!0),r(c,null,u(h.parts,(t=>(a(),r(g,{part:t},null,8,["part"])))),256))])),n("div",Z,[n(_,{disabled:!h.prevPage,raised:"",onClick:h.handlePrev},{default:Q((()=>[tt])),_:1},8,["disabled","onClick"]),n("div",null,l(h.getCurrentPageNumber()||0)+" / "+l(h.getTotalPages()||0),1),n(_,{disabled:!h.nextPage,raised:"",onClick:h.handleNext},{default:Q((()=>[et])),_:1},8,["disabled","onClick"])])])):d("",!0)}));H.render=st,H.__scopeId="data-v-6acd8266";var at={name:"app",components:{PartsList:H,PartCard:T,SetCard:b,Header:P},data:()=>({loading:!1,partsCount:0}),computed:{set(){return this.$store.state.set}},methods:{async onSelect(t){const e=w();if(e)await this.$store.dispatch("setSet",e);else{const e=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets/${t}`,{headers:{Authorization:`key ${{}.VITE_API_KEY}`}});await this.$store.dispatch("setSet",e.data),localStorage.getItem(this.set.set_num)||localStorage.setItem(this.set.set_num,JSON.stringify(this.set))}},async getParts(){await this.$store.dispatch("setParts",[]),this.loading=!0;const t=await this.$http.get(`${{}.VITE_API_BASE_URL}/lego/sets/${this.set.set_num}/parts`,{headers:{Authorization:`key ${{}.VITE_API_KEY}`},params:{page_size:5}});this.handleResponseParts(t)},async getPartsPage(t){await this.$store.dispatch("setParts",[]),this.loading=!0;const e=await this.$http.get(t,{headers:{Authorization:`key ${{}.VITE_API_KEY}`}});this.handleResponseParts(e)},handleResponseParts(t){t.data.results.forEach((t=>{const e=((t,e)=>{var s;const a=w(t);return a?null==(s=a.parts)?void 0:s.find((t=>t.id===e.id)):void 0})(this.set.set_num,t);e?this.$store.dispatch("pushPart",e):this.$store.dispatch("pushPart",t)})),this.loading=!1,this.partsCount=t.data.count,this.$store.dispatch("setNextPage",t.data.next),this.$store.dispatch("setPrevPage",t.data.previous),((t,e)=>{const s=w(t);if(!s)throw new Error(`set with id ${t} was not found in local storage`);e.forEach((t=>{var e,a,r;s.parts||(s.parts=[]),(null==(a=null==(e=s.parts)?void 0:e.map((t=>t.id)))?void 0:a.includes(t.id))||null==(r=s.parts)||r.push(t)})),localStorage.setItem(t,JSON.stringify(s))})(this.set.set_num,this.$store.state.parts)}}};const rt={id:"root"},nt=n("hr",{style:{margin:"0"}},null,-1);at.render=function(t,e,i,o,l,d){const u=s("Header"),p=s("SetCard"),h=s("PartsList");return a(),r(c,null,[n(u,{"content-selector":"#root",onSetSelected:d.onSelect},null,8,["onSetSelected"]),n("div",rt,[n(p,{onFetchParts:d.getParts},null,8,["onFetchParts"]),nt,n(h,{loading:l.loading,"parts-count":l.partsCount,onGetPartsPage:d.getPartsPage},null,8,["loading","parts-count","onGetPartsPage"])])],64)};const it=Symbol(),ot=p({state:{set:void 0,parts:[],prevPage:"",nextPage:""},mutations:{setSet(t,e){t.set=e,localStorage.getItem(e.set_num)||localStorage.setItem(e.set_num,JSON.stringify(e))},setParts(t,e){t.parts=e},pushPart(t,e){var s;null==(s=t.parts)||s.push(e)},setPrevPage(t,e){t.prevPage=e},setNextPage(t,e){t.nextPage=e}},actions:{setSet(t,e){t.commit("setSet",e)},setParts(t,e){t.commit("setParts",e)},pushPart(t,e){t.commit("pushPart",e)},setPrevPage(t,e){t.commit("setPrevPage",e)},setNextPage(t,e){t.commit("setNextPage",e)}}}),lt=h(at);lt.use(m,g),lt.use(_),lt.use(v),lt.use(ot,it),lt.mount("#app");
